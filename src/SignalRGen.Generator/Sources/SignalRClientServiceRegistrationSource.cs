using System.Text;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp;
using Microsoft.CodeAnalysis.CSharp.Syntax;
using Microsoft.CodeAnalysis.Text;
using static Microsoft.CodeAnalysis.CSharp.SyntaxFactory;

namespace SignalRGen.Generator.Sources;

internal static class SignalRClientServiceRegistrationSource
{
    public static SourceText GetSource(
        IEnumerable<HubClientToGenerate> hubClientToGenerate)
    {
        var memberList =
            new List<MemberDeclarationSyntax>()
            {
                CreateAddSignalRHubsMethod()
            };
        foreach (var hubClient in hubClientToGenerate)
        {
            memberList.Add(CreateWithHubMethod(hubClient));
        }

        memberList.Add(CreateDefaultRetrySteps());

        return CompilationUnit()
            .WithUsings(
                List<UsingDirectiveSyntax>(
                    new UsingDirectiveSyntax[]
                    {
                        UsingDirective(
                            QualifiedName(
                                QualifiedName(
                                    QualifiedName(
                                            IdentifierName("SignalRGen"),
                                            IdentifierName("Generator")),
                                    IdentifierName("Client")),
                                IdentifierName("Configuration")))
                            .WithUsingKeyword(AutoGeneratedHintSource.GetSyntaxToken(SyntaxKind.UsingKeyword)),
                        UsingDirective(
                            QualifiedName(
                                QualifiedName(
                                    QualifiedName(
                                        IdentifierName("Microsoft"),
                                        IdentifierName("AspNetCore")),
                                    IdentifierName("SignalR")),
                                IdentifierName("Client"))),
                        UsingDirective(
                            QualifiedName(
                                QualifiedName(
                                    IdentifierName("Microsoft"),
                                    IdentifierName("Extensions")),
                                IdentifierName("DependencyInjection")))
                    }))
            .WithMembers(
                SingletonList<MemberDeclarationSyntax>(
                    FileScopedNamespaceDeclaration(
                            QualifiedName(
                                QualifiedName(
                                    QualifiedName(
                                        QualifiedName(
                                            IdentifierName("SignalRGen"),
                                            IdentifierName("Generator")),
                                        IdentifierName("Client")),
                                    IdentifierName("Extensions")),
                                IdentifierName("DependencyInjection")))
                        .WithNamespaceKeyword(NullableEnabledSource.GetSyntaxToken(SyntaxKind.NamespaceKeyword))
            .WithMembers(
                SingletonList<MemberDeclarationSyntax>(
                    ClassDeclaration("SignalRClientServiceRegistration")
                        .WithModifiers(
                            TokenList(
                                new[]
                                {
                                    Token(SyntaxKind.PublicKeyword),
                                    Token(SyntaxKind.StaticKeyword)
                                }))
                        .WithMembers(
                            List<MemberDeclarationSyntax>(
                                memberList))))))
            .NormalizeWhitespace().GetText(Encoding.UTF8);
    }

    private static MethodDeclarationSyntax CreateWithHubMethod(
        HubClientToGenerate hubClient)
    {
        return MethodDeclaration(
                    IdentifierName("SignalRHubServiceCollection"),
                    Identifier($"With{hubClient.HubName}"))
                .WithModifiers(
                    TokenList(
                        new[]{
                            Token(
                                TriviaList(
                                    Trivia(
                                        DocumentationCommentTrivia(
                                            SyntaxKind.SingleLineDocumentationCommentTrivia,
                                            List<XmlNodeSyntax>(
                                                new XmlNodeSyntax[]{
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            XmlTextLiteral(
                                                                TriviaList(
                                                                    DocumentationCommentExterior("///")),
                                                                " ",
                                                                " ",
                                                                TriviaList()))),
                                                    XmlExampleElement(
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                new []{
                                                                    XmlTextNewLine(
                                                                        TriviaList(),
                                                                        "\n",
                                                                        "\n",
                                                                        TriviaList()),
                                                                    XmlTextLiteral(
                                                                        TriviaList(
                                                                            DocumentationCommentExterior("    ///")),
                                                                        " Registers the ",
                                                                        " Registers the ",
                                                                        TriviaList())})),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName(hubClient.HubName))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    " in the ",
                                                                    " in the ",
                                                                    TriviaList()))),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName("ServiceCollection"))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                new []{
                                                                    XmlTextLiteral(
                                                                        TriviaList(),
                                                                        ".",
                                                                        ".",
                                                                        TriviaList()),
                                                                    XmlTextNewLine(
                                                                        TriviaList(),
                                                                        "\n",
                                                                        "\n",
                                                                        TriviaList()),
                                                                    XmlTextLiteral(
                                                                        TriviaList(
                                                                            DocumentationCommentExterior("    ///")),
                                                                        " ",
                                                                        " ",
                                                                        TriviaList())})))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier("summary"))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier("summary")))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                new []{
                                                                    XmlTextNewLine(
                                                                        TriviaList(),
                                                                        "\n",
                                                                        "\n",
                                                                        TriviaList()),
                                                                    XmlTextLiteral(
                                                                        TriviaList(
                                                                            DocumentationCommentExterior("    ///")),
                                                                        " ",
                                                                        " ",
                                                                        TriviaList())})),
                                                        XmlExampleElement(
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            " By default the ",
                                                                            " By default the ",
                                                                            TriviaList())})),
                                                            XmlNullKeywordElement()
                                                            .WithAttributes(
                                                                SingletonList<XmlAttributeSyntax>(
                                                                    XmlCrefAttribute(
                                                                        NameMemberCref(
                                                                            IdentifierName(hubClient.HubName))))),
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    XmlTextLiteral(
                                                                        TriviaList(),
                                                                        " is registered with ",
                                                                        " is registered with ",
                                                                        TriviaList()))),
                                                            XmlNullKeywordElement()
                                                            .WithAttributes(
                                                                SingletonList<XmlAttributeSyntax>(
                                                                    XmlCrefAttribute(
                                                                        NameMemberCref(
                                                                            IdentifierName("ServiceLifetime"))))),
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextLiteral(
                                                                            TriviaList(),
                                                                            " singleton.",
                                                                            " singleton.",
                                                                            TriviaList()),
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            " ",
                                                                            " ",
                                                                            TriviaList())})))
                                                        .WithStartTag(
                                                            XmlElementStartTag(
                                                                XmlName(
                                                                    Identifier("para"))))
                                                        .WithEndTag(
                                                            XmlElementEndTag(
                                                                XmlName(
                                                                    Identifier("para")))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                new []{
                                                                    XmlTextNewLine(
                                                                        TriviaList(),
                                                                        "\n",
                                                                        "\n",
                                                                        TriviaList()),
                                                                    XmlTextLiteral(
                                                                        TriviaList(
                                                                            DocumentationCommentExterior("    ///")),
                                                                        " If no ",
                                                                        " If no ",
                                                                        TriviaList())})),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName("IRetryPolicy"))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    " is configured for the ",
                                                                    " is configured for the ",
                                                                    TriviaList()))),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName("HubConnectionBuilder"))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                new []{
                                                                    XmlTextLiteral(
                                                                        TriviaList(),
                                                                        " a default retry policy will be used.",
                                                                        " a default retry policy will be used.",
                                                                        TriviaList()),
                                                                    XmlTextNewLine(
                                                                        TriviaList(),
                                                                        "\n",
                                                                        "\n",
                                                                        TriviaList()),
                                                                    XmlTextLiteral(
                                                                        TriviaList(
                                                                            DocumentationCommentExterior("    ///")),
                                                                        " ",
                                                                        " ",
                                                                        TriviaList())})),
                                                        XmlExampleElement(
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            "     ",
                                                                            "     ",
                                                                            TriviaList())})),
                                                            XmlExampleElement(
                                                                SingletonList<XmlNodeSyntax>(
                                                                    XmlText()
                                                                    .WithTextTokens(
                                                                        TokenList(
                                                                            new []{
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList()),
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior("    ///")),
                                                                                    "         Every second - 10 attempts",
                                                                                    "         Every second - 10 attempts",
                                                                                    TriviaList()),
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList()),
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior("    ///")),
                                                                                    "     ",
                                                                                    "     ",
                                                                                    TriviaList())}))))
                                                            .WithStartTag(
                                                                XmlElementStartTag(
                                                                    XmlName(
                                                                        Identifier("item"))))
                                                            .WithEndTag(
                                                                XmlElementEndTag(
                                                                    XmlName(
                                                                        Identifier("item")))),
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            "     ",
                                                                            "     ",
                                                                            TriviaList())})),
                                                            XmlExampleElement(
                                                                SingletonList<XmlNodeSyntax>(
                                                                    XmlText()
                                                                    .WithTextTokens(
                                                                        TokenList(
                                                                            new []{
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList()),
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior("    ///")),
                                                                                    "         Every 3 seconds - 5 attempts",
                                                                                    "         Every 3 seconds - 5 attempts",
                                                                                    TriviaList()),
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList()),
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior("    ///")),
                                                                                    "     ",
                                                                                    "     ",
                                                                                    TriviaList())}))))
                                                            .WithStartTag(
                                                                XmlElementStartTag(
                                                                    XmlName(
                                                                        Identifier("item"))))
                                                            .WithEndTag(
                                                                XmlElementEndTag(
                                                                    XmlName(
                                                                        Identifier("item")))),
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            "     ",
                                                                            "     ",
                                                                            TriviaList())})),
                                                            XmlExampleElement(
                                                                SingletonList<XmlNodeSyntax>(
                                                                    XmlText()
                                                                    .WithTextTokens(
                                                                        TokenList(
                                                                            new []{
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList()),
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior("    ///")),
                                                                                    "         Every 10 seconds - 2 attempts",
                                                                                    "         Every 10 seconds - 2 attempts",
                                                                                    TriviaList()),
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList()),
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior("    ///")),
                                                                                    "     ",
                                                                                    "     ",
                                                                                    TriviaList())}))))
                                                            .WithStartTag(
                                                                XmlElementStartTag(
                                                                    XmlName(
                                                                        Identifier("item"))))
                                                            .WithEndTag(
                                                                XmlElementEndTag(
                                                                    XmlName(
                                                                        Identifier("item")))),
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            " ",
                                                                            " ",
                                                                            TriviaList())})))
                                                        .WithStartTag(
                                                            XmlElementStartTag(
                                                                XmlName(
                                                                    Identifier("list")))
                                                            .WithAttributes(
                                                                SingletonList<XmlAttributeSyntax>(
                                                                    XmlTextAttribute(
                                                                        XmlName(
                                                                            Identifier(
                                                                                TriviaList(),
                                                                                SyntaxKind.TypeKeyword,
                                                                                "type",
                                                                                "type",
                                                                                TriviaList())),
                                                                        Token(SyntaxKind.DoubleQuoteToken),
                                                                        Token(SyntaxKind.DoubleQuoteToken))
                                                                    .WithTextTokens(
                                                                        TokenList(
                                                                            XmlTextLiteral(
                                                                                TriviaList(),
                                                                                "bullet",
                                                                                "bullet",
                                                                                TriviaList()))))))
                                                        .WithEndTag(
                                                            XmlElementEndTag(
                                                                XmlName(
                                                                    Identifier("list")))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                new []{
                                                                    XmlTextNewLine(
                                                                        TriviaList(),
                                                                        "\n",
                                                                        "\n",
                                                                        TriviaList()),
                                                                    XmlTextLiteral(
                                                                        TriviaList(
                                                                            DocumentationCommentExterior("    ///")),
                                                                        " ",
                                                                        " ",
                                                                        TriviaList())})))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier("remarks"))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier("remarks")))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    "The ",
                                                                    "The ",
                                                                    TriviaList()))),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName("SignalRHubServiceCollection"))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    " to register the Hub.",
                                                                    " to register the Hub.",
                                                                    TriviaList()))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlNameAttribute(
                                                                    XmlName(
                                                                        Identifier("name")),
                                                                    Token(SyntaxKind.DoubleQuoteToken),
                                                                    IdentifierName("services"),
                                                                    Token(SyntaxKind.DoubleQuoteToken)))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        SingletonList<XmlNodeSyntax>(
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    XmlTextLiteral(
                                                                        TriviaList(),
                                                                        "An action used to configure the provided options.",
                                                                        "An action used to configure the provided options.",
                                                                        TriviaList())))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlNameAttribute(
                                                                    XmlName(
                                                                        Identifier("name")),
                                                                    Token(SyntaxKind.DoubleQuoteToken),
                                                                    IdentifierName("configuration"),
                                                                    Token(SyntaxKind.DoubleQuoteToken)))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    "The ",
                                                                    "The ",
                                                                    TriviaList()))),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName("SignalRHubServiceCollection"))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    " to register additional Hubs.",
                                                                    " to register additional Hubs.",
                                                                    TriviaList()))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier("returns"))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier("returns")))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            XmlTextNewLine(
                                                                TriviaList(),
                                                                "\n",
                                                                "\n",
                                                                TriviaList())))})))),
                                SyntaxKind.PublicKeyword,
                                TriviaList()),
                            Token(SyntaxKind.StaticKeyword)}))
                .WithParameterList(
                    ParameterList(
                        SeparatedList<ParameterSyntax>(
                            new SyntaxNodeOrToken[]{
                                Parameter(
                                    Identifier("services"))
                                .WithModifiers(
                                    TokenList(
                                        Token(SyntaxKind.ThisKeyword)))
                                .WithType(
                                    IdentifierName("SignalRHubServiceCollection")),
                                Token(SyntaxKind.CommaToken),
                                Parameter(
                                    Identifier("configuration"))
                                .WithType(
                                    NullableType(
                                        GenericName(
                                            Identifier("Action"))
                                        .WithTypeArgumentList(
                                            TypeArgumentList(
                                                SingletonSeparatedList<TypeSyntax>(
                                                    IdentifierName("HubClientOptions"))))))
                                .WithDefault(
                                    EqualsValueClause(
                                        LiteralExpression(
                                            SyntaxKind.NullLiteralExpression)))})))
                .WithBody(
                    Block(
                            ExpressionStatement(
                                InvocationExpression(
                                    MemberAccessExpression(
                                        SyntaxKind.SimpleMemberAccessExpression,
                                        IdentifierName("ArgumentNullException"),
                                        IdentifierName("ThrowIfNull")))
                                .WithArgumentList(
                                    ArgumentList(
                                        SingletonSeparatedList<ArgumentSyntax>(
                                            Argument(
                                                IdentifierName("services")))))),
                            LocalDeclarationStatement(
                                VariableDeclaration(
                                    IdentifierName(
                                        Identifier(
                                            TriviaList(),
                                            SyntaxKind.VarKeyword,
                                            "var",
                                            "var",
                                            TriviaList())))
                                .WithVariables(
                                    SingletonSeparatedList<VariableDeclaratorSyntax>(
                                        VariableDeclarator(
                                            Identifier("config"))
                                        .WithInitializer(
                                            EqualsValueClause(
                                                ObjectCreationExpression(
                                                    IdentifierName("HubClientOptions"))
                                                .WithArgumentList(
                                                    ArgumentList())))))),
                            ExpressionStatement(
                                ConditionalAccessExpression(
                                    IdentifierName("configuration"),
                                    InvocationExpression(
                                        MemberBindingExpression(
                                            IdentifierName("Invoke")))
                                    .WithArgumentList(
                                        ArgumentList(
                                            SingletonSeparatedList<ArgumentSyntax>(
                                                Argument(
                                                    IdentifierName("config"))))))),
                            ExpressionStatement(
                                InvocationExpression(
                                    MemberAccessExpression(
                                        SyntaxKind.SimpleMemberAccessExpression,
                                        MemberAccessExpression(
                                            SyntaxKind.SimpleMemberAccessExpression,
                                            IdentifierName("services"),
                                            IdentifierName("Services")),
                                        IdentifierName("Add")))
                                .WithArgumentList(
                                    ArgumentList(
                                        SingletonSeparatedList<ArgumentSyntax>(
                                            Argument(
                                                ObjectCreationExpression(
                                                    IdentifierName("ServiceDescriptor"))
                                                .WithArgumentList(
                                                    ArgumentList(
                                                        SeparatedList<ArgumentSyntax>(
                                                            new SyntaxNodeOrToken[]{
                                                                Argument(
                                                                    TypeOfExpression(
                                                                        IdentifierName(hubClient.HubName))),
                                                                Token(SyntaxKind.CommaToken),
                                                                Argument(
                                                                    SimpleLambdaExpression(
                                                                        Parameter(
                                                                            Identifier(
                                                                                TriviaList(),
                                                                                SyntaxKind.UnderscoreToken,
                                                                                "_",
                                                                                "_",
                                                                                TriviaList())))
                                                                    .WithBlock(
                                                                        Block(
                                                                            LocalDeclarationStatement(
                                                                                VariableDeclaration(
                                                                                    IdentifierName(
                                                                                        Identifier(
                                                                                            TriviaList(),
                                                                                            SyntaxKind.VarKeyword,
                                                                                            "var",
                                                                                            "var",
                                                                                            TriviaList())))
                                                                                .WithVariables(
                                                                                    SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                                        VariableDeclarator(
                                                                                            Identifier("hubConnectionBuilder"))
                                                                                        .WithInitializer(
                                                                                            EqualsValueClause(
                                                                                                InvocationExpression(
                                                                                                    MemberAccessExpression(
                                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                                        InvocationExpression(
                                                                                                            MemberAccessExpression(
                                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                                ObjectCreationExpression(
                                                                                                                    IdentifierName("HubConnectionBuilder"))
                                                                                                                .WithArgumentList(
                                                                                                                    ArgumentList()),
                                                                                                                IdentifierName("WithUrl")))
                                                                                                        .WithArgumentList(
                                                                                                            ArgumentList(
                                                                                                                SingletonSeparatedList<ArgumentSyntax>(
                                                                                                                    Argument(
                                                                                                                        ObjectCreationExpression(
                                                                                                                            IdentifierName("Uri"))
                                                                                                                        .WithArgumentList(
                                                                                                                            ArgumentList(
                                                                                                                                SeparatedList<ArgumentSyntax>(
                                                                                                                                    new SyntaxNodeOrToken[]{
                                                                                                                                        Argument(
                                                                                                                                            MemberAccessExpression(
                                                                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                                                                MemberAccessExpression(
                                                                                                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                                                                                                    IdentifierName("services"),
                                                                                                                                                    IdentifierName("GeneralConfiguration")),
                                                                                                                                                IdentifierName("HubBaseUri"))),
                                                                                                                                        Token(SyntaxKind.CommaToken),
                                                                                                                                        Argument(
                                                                                                                                            MemberAccessExpression(
                                                                                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                                                                                IdentifierName(hubClient.HubName),
                                                                                                                                                IdentifierName("HubUri")))}))))))),
                                                                                                        IdentifierName("WithAutomaticReconnect")))
                                                                                                .WithArgumentList(
                                                                                                    ArgumentList(
                                                                                                        SingletonSeparatedList<ArgumentSyntax>(
                                                                                                            Argument(
                                                                                                                InvocationExpression(
                                                                                                                    MemberAccessExpression(
                                                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                                                        IdentifierName("DefaultRetrySteps"),
                                                                                                                        IdentifierName("ToArray")))))))))))),
                                                                            ExpressionStatement(
                                                                                ConditionalAccessExpression(
                                                                                    MemberAccessExpression(
                                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                                        IdentifierName("config"),
                                                                                        IdentifierName("HubConnectionBuilderConfiguration")),
                                                                                    InvocationExpression(
                                                                                            MemberBindingExpression(
                                                                                                IdentifierName("Invoke")))
                                                                                        .WithArgumentList(
                                                                                            ArgumentList(
                                                                                                SingletonSeparatedList<ArgumentSyntax>(
                                                                                                    Argument(
                                                                                                        IdentifierName("hubConnectionBuilder"))))))),
                                                                            ReturnStatement(
                                                                                ObjectCreationExpression(
                                                                                    IdentifierName(hubClient.HubName))
                                                                                .WithArgumentList(
                                                                                    ArgumentList(
                                                                                        SingletonSeparatedList<ArgumentSyntax>(
                                                                                            Argument(
                                                                                                IdentifierName("hubConnectionBuilder")))))))))
                                                                .WithNameColon(
                                                                    NameColon(
                                                                        IdentifierName("factory"))),
                                                                Token(SyntaxKind.CommaToken),
                                                                Argument(
                                                                    MemberAccessExpression(
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        IdentifierName("config"),
                                                                        IdentifierName("HubClientLifetime")))})))))))),
                            ReturnStatement(
                                IdentifierName("services"))));
    }

    private static MethodDeclarationSyntax CreateAddSignalRHubsMethod()
    {
        return MethodDeclaration(
                    IdentifierName("SignalRHubServiceCollection"),
                    Identifier("AddSignalRHubs"))
                .WithModifiers(
                    TokenList(
                        new[]{
                            Token(
                                TriviaList(
                                    Trivia(
                                        DocumentationCommentTrivia(
                                            SyntaxKind.SingleLineDocumentationCommentTrivia,
                                            List<XmlNodeSyntax>(
                                                new XmlNodeSyntax[]{
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            XmlTextLiteral(
                                                                TriviaList(
                                                                    DocumentationCommentExterior("///")),
                                                                " ",
                                                                " ",
                                                                TriviaList()))),
                                                    XmlExampleElement(
                                                        SingletonList<XmlNodeSyntax>(
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    new []{
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            " Creates the base configuration for all registered Hubs. The Hubs you want to use must be registered with the appropriate `With{...}` call.",
                                                                            " Creates the base configuration for all registered Hubs. The Hubs you want to use must be registered with the appropriate `With{...}` call.",
                                                                            TriviaList()),
                                                                        XmlTextNewLine(
                                                                            TriviaList(),
                                                                            "\n",
                                                                            "\n",
                                                                            TriviaList()),
                                                                        XmlTextLiteral(
                                                                            TriviaList(
                                                                                DocumentationCommentExterior("    ///")),
                                                                            " ",
                                                                            " ",
                                                                            TriviaList())}))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier("summary"))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier("summary")))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        SingletonList<XmlNodeSyntax>(
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    XmlTextLiteral(
                                                                        TriviaList(),
                                                                        "The services available in the application.",
                                                                        "The services available in the application.",
                                                                        TriviaList())))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlNameAttribute(
                                                                    XmlName(
                                                                        Identifier("name")),
                                                                    Token(SyntaxKind.DoubleQuoteToken),
                                                                    IdentifierName("services"),
                                                                    Token(SyntaxKind.DoubleQuoteToken)))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        SingletonList<XmlNodeSyntax>(
                                                            XmlText()
                                                            .WithTextTokens(
                                                                TokenList(
                                                                    XmlTextLiteral(
                                                                        TriviaList(),
                                                                        "An action used to configure the provided options.",
                                                                        "An action used to configure the provided options.",
                                                                        TriviaList())))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlNameAttribute(
                                                                    XmlName(
                                                                        Identifier("name")),
                                                                    Token(SyntaxKind.DoubleQuoteToken),
                                                                    IdentifierName("generalConfiguration"),
                                                                    Token(SyntaxKind.DoubleQuoteToken)))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier(
                                                                    TriviaList(),
                                                                    SyntaxKind.ParamKeyword,
                                                                    "param",
                                                                    "param",
                                                                    TriviaList())))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            new []{
                                                                XmlTextNewLine(
                                                                    TriviaList(),
                                                                    "\n",
                                                                    "\n",
                                                                    TriviaList()),
                                                                XmlTextLiteral(
                                                                    TriviaList(
                                                                        DocumentationCommentExterior("    ///")),
                                                                    " ",
                                                                    " ",
                                                                    TriviaList())})),
                                                    XmlExampleElement(
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    "The ",
                                                                    "The ",
                                                                    TriviaList()))),
                                                        XmlNullKeywordElement()
                                                        .WithAttributes(
                                                            SingletonList<XmlAttributeSyntax>(
                                                                XmlCrefAttribute(
                                                                    NameMemberCref(
                                                                        IdentifierName("SignalRHubServiceCollection"))))),
                                                        XmlText()
                                                        .WithTextTokens(
                                                            TokenList(
                                                                XmlTextLiteral(
                                                                    TriviaList(),
                                                                    " to register the specified Hub.",
                                                                    " to register the specified Hub.",
                                                                    TriviaList()))))
                                                    .WithStartTag(
                                                        XmlElementStartTag(
                                                            XmlName(
                                                                Identifier("returns"))))
                                                    .WithEndTag(
                                                        XmlElementEndTag(
                                                            XmlName(
                                                                Identifier("returns")))),
                                                    XmlText()
                                                    .WithTextTokens(
                                                        TokenList(
                                                            XmlTextNewLine(
                                                                TriviaList(),
                                                                "\n",
                                                                "\n",
                                                                TriviaList())))})))),
                                SyntaxKind.PublicKeyword,
                                TriviaList()),
                            Token(SyntaxKind.StaticKeyword)}))
                .WithParameterList(
                    ParameterList(
                        SeparatedList<ParameterSyntax>(
                            new SyntaxNodeOrToken[]{
                                Parameter(
                                    Identifier("services"))
                                .WithModifiers(
                                    TokenList(
                                        Token(SyntaxKind.ThisKeyword)))
                                .WithType(
                                    IdentifierName("IServiceCollection")),
                                Token(SyntaxKind.CommaToken),
                                Parameter(
                                    Identifier("generalConfiguration"))
                                .WithType(
                                    GenericName(
                                        Identifier("Action"))
                                    .WithTypeArgumentList(
                                        TypeArgumentList(
                                            SingletonSeparatedList<TypeSyntax>(
                                                IdentifierName("SignalROptions")))))})))
                .WithBody(
                    Block(
                        ExpressionStatement(
                            InvocationExpression(
                                MemberAccessExpression(
                                    SyntaxKind.SimpleMemberAccessExpression,
                                    IdentifierName("ArgumentNullException"),
                                    IdentifierName("ThrowIfNull")))
                            .WithArgumentList(
                                ArgumentList(
                                    SingletonSeparatedList<ArgumentSyntax>(
                                        Argument(
                                            IdentifierName("generalConfiguration")))))),
                        LocalDeclarationStatement(
                            VariableDeclaration(
                                IdentifierName(
                                    Identifier(
                                        TriviaList(),
                                        SyntaxKind.VarKeyword,
                                        "var",
                                        "var",
                                        TriviaList())))
                            .WithVariables(
                                SingletonSeparatedList<VariableDeclaratorSyntax>(
                                    VariableDeclarator(
                                        Identifier("config"))
                                    .WithInitializer(
                                        EqualsValueClause(
                                            ObjectCreationExpression(
                                                IdentifierName("SignalROptions"))
                                            .WithArgumentList(
                                                ArgumentList())))))),
                        ExpressionStatement(
                            InvocationExpression(
                                MemberAccessExpression(
                                    SyntaxKind.SimpleMemberAccessExpression,
                                    IdentifierName("generalConfiguration"),
                                    IdentifierName("Invoke")))
                            .WithArgumentList(
                                ArgumentList(
                                    SingletonSeparatedList<ArgumentSyntax>(
                                        Argument(
                                            IdentifierName("config")))))),
                        ReturnStatement(
                            ObjectCreationExpression(
                                IdentifierName("SignalRHubServiceCollection"))
                            .WithArgumentList(
                                ArgumentList(
                                    SeparatedList<ArgumentSyntax>(
                                        new SyntaxNodeOrToken[]{
                                            Argument(
                                                IdentifierName("services")),
                                            Token(SyntaxKind.CommaToken),
                                            Argument(
                                                IdentifierName("config"))}))))));
    }

    private static MemberDeclarationSyntax CreateDefaultRetrySteps()
    {
        return PropertyDeclaration(
                GenericName(
                        Identifier("IEnumerable"))
                    .WithTypeArgumentList(
                        TypeArgumentList(
                            SingletonSeparatedList<TypeSyntax>(
                                IdentifierName("TimeSpan")))),
                Identifier("DefaultRetrySteps"))
            .WithModifiers(
                TokenList(
                    new[]
                    {
                        Token(SyntaxKind.PrivateKeyword),
                        Token(SyntaxKind.StaticKeyword)
                    }))
            .WithAccessorList(
                AccessorList(
                    SingletonList<AccessorDeclarationSyntax>(
                        AccessorDeclaration(
                                SyntaxKind.GetAccessorDeclaration)
                            .WithBody(
                                Block(
                                    LocalDeclarationStatement(
                                        VariableDeclaration(
                                                IdentifierName(
                                                    Identifier(
                                                        TriviaList(),
                                                        SyntaxKind.VarKeyword,
                                                        "var",
                                                        "var",
                                                        TriviaList())))
                                            .WithVariables(
                                                SingletonSeparatedList<
                                                    VariableDeclaratorSyntax>(
                                                    VariableDeclarator(
                                                            Identifier(
                                                                "retrySteps"))
                                                        .WithInitializer(
                                                            EqualsValueClause(
                                                                InvocationExpression(
                                                                        MemberAccessExpression(
                                                                            SyntaxKind
                                                                                .SimpleMemberAccessExpression,
                                                                            IdentifierName(
                                                                                "Enumerable"),
                                                                            IdentifierName(
                                                                                "Repeat")))
                                                                    .WithArgumentList(
                                                                        ArgumentList(
                                                                            SeparatedList
                                                                                <ArgumentSyntax>(
                                                                                    new
                                                                                        SyntaxNodeOrToken
                                                                                        []
                                                                                        {
                                                                                            Argument(
                                                                                                InvocationExpression(
                                                                                                        MemberAccessExpression(
                                                                                                            SyntaxKind
                                                                                                                .SimpleMemberAccessExpression,
                                                                                                            IdentifierName(
                                                                                                                "TimeSpan"),
                                                                                                            IdentifierName(
                                                                                                                "FromSeconds")))
                                                                                                    .WithArgumentList(
                                                                                                        ArgumentList(
                                                                                                            SingletonSeparatedList
                                                                                                                <ArgumentSyntax>(
                                                                                                                    Argument(
                                                                                                                        LiteralExpression(
                                                                                                                            SyntaxKind
                                                                                                                                .NumericLiteralExpression,
                                                                                                                            Literal(
                                                                                                                                1))))))),
                                                                                            Token(
                                                                                                SyntaxKind
                                                                                                    .CommaToken),
                                                                                            Argument(
                                                                                                LiteralExpression(
                                                                                                    SyntaxKind
                                                                                                        .NumericLiteralExpression,
                                                                                                    Literal(
                                                                                                        10)))
                                                                                        })))))))),
                                    ExpressionStatement(
                                        AssignmentExpression(
                                            SyntaxKind
                                                .SimpleAssignmentExpression,
                                            IdentifierName("retrySteps"),
                                            InvocationExpression(
                                                    MemberAccessExpression(
                                                        SyntaxKind
                                                            .SimpleMemberAccessExpression,
                                                        IdentifierName(
                                                            "retrySteps"),
                                                        IdentifierName(
                                                            "Concat")))
                                                .WithArgumentList(
                                                    ArgumentList(
                                                        SingletonSeparatedList<
                                                            ArgumentSyntax>(
                                                            Argument(
                                                                InvocationExpression(
                                                                        MemberAccessExpression(
                                                                            SyntaxKind
                                                                                .SimpleMemberAccessExpression,
                                                                            IdentifierName(
                                                                                "Enumerable"),
                                                                            IdentifierName(
                                                                                "Repeat")))
                                                                    .WithArgumentList(
                                                                        ArgumentList(
                                                                            SeparatedList
                                                                                <ArgumentSyntax>(
                                                                                    new
                                                                                        SyntaxNodeOrToken
                                                                                        []
                                                                                        {
                                                                                            Argument(
                                                                                                InvocationExpression(
                                                                                                        MemberAccessExpression(
                                                                                                            SyntaxKind
                                                                                                                .SimpleMemberAccessExpression,
                                                                                                            IdentifierName(
                                                                                                                "TimeSpan"),
                                                                                                            IdentifierName(
                                                                                                                "FromSeconds")))
                                                                                                    .WithArgumentList(
                                                                                                        ArgumentList(
                                                                                                            SingletonSeparatedList
                                                                                                                <ArgumentSyntax>(
                                                                                                                    Argument(
                                                                                                                        LiteralExpression(
                                                                                                                            SyntaxKind
                                                                                                                                .NumericLiteralExpression,
                                                                                                                            Literal(
                                                                                                                                3))))))),
                                                                                            Token(
                                                                                                SyntaxKind
                                                                                                    .CommaToken),
                                                                                            Argument(
                                                                                                LiteralExpression(
                                                                                                    SyntaxKind
                                                                                                        .NumericLiteralExpression,
                                                                                                    Literal(
                                                                                                        5)))
                                                                                        }))))))))),
                                    ExpressionStatement(
                                        AssignmentExpression(
                                            SyntaxKind
                                                .SimpleAssignmentExpression,
                                            IdentifierName("retrySteps"),
                                            InvocationExpression(
                                                    MemberAccessExpression(
                                                        SyntaxKind
                                                            .SimpleMemberAccessExpression,
                                                        IdentifierName(
                                                            "retrySteps"),
                                                        IdentifierName(
                                                            "Concat")))
                                                .WithArgumentList(
                                                    ArgumentList(
                                                        SingletonSeparatedList<
                                                            ArgumentSyntax>(
                                                            Argument(
                                                                InvocationExpression(
                                                                        MemberAccessExpression(
                                                                            SyntaxKind
                                                                                .SimpleMemberAccessExpression,
                                                                            IdentifierName(
                                                                                "Enumerable"),
                                                                            IdentifierName(
                                                                                "Repeat")))
                                                                    .WithArgumentList(
                                                                        ArgumentList(
                                                                            SeparatedList
                                                                                <ArgumentSyntax>(
                                                                                    new
                                                                                        SyntaxNodeOrToken
                                                                                        []
                                                                                        {
                                                                                            Argument(
                                                                                                InvocationExpression(
                                                                                                        MemberAccessExpression(
                                                                                                            SyntaxKind
                                                                                                                .SimpleMemberAccessExpression,
                                                                                                            IdentifierName(
                                                                                                                "TimeSpan"),
                                                                                                            IdentifierName(
                                                                                                                "FromSeconds")))
                                                                                                    .WithArgumentList(
                                                                                                        ArgumentList(
                                                                                                            SingletonSeparatedList
                                                                                                                <ArgumentSyntax>(
                                                                                                                    Argument(
                                                                                                                        LiteralExpression(
                                                                                                                            SyntaxKind
                                                                                                                                .NumericLiteralExpression,
                                                                                                                            Literal(
                                                                                                                                10))))))),
                                                                                            Token(
                                                                                                SyntaxKind
                                                                                                    .CommaToken),
                                                                                            Argument(
                                                                                                LiteralExpression(
                                                                                                    SyntaxKind
                                                                                                        .NumericLiteralExpression,
                                                                                                    Literal(
                                                                                                        2)))
                                                                                        }))))))))),
                                    ReturnStatement(
                                        IdentifierName("retrySteps")))))));
    }
}
