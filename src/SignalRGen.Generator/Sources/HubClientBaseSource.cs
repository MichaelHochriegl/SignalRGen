using System.Text;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp;
using Microsoft.CodeAnalysis.CSharp.Syntax;
using Microsoft.CodeAnalysis.Text;
using static Microsoft.CodeAnalysis.CSharp.SyntaxFactory;

namespace SignalRGen.Generator.Sources;

internal static class HubClientBaseSource
{
    internal static SourceText GetSource() => CompilationUnit()
        .WithUsings(
            SingletonList<UsingDirectiveSyntax>(
                UsingDirective(
                    QualifiedName(
                        QualifiedName(
                            QualifiedName(
                                IdentifierName("Microsoft"),
                                IdentifierName("AspNetCore")),
                            IdentifierName("SignalR")),
                        IdentifierName("Client")))
                    .WithUsingKeyword(AutoGeneratedHintSource.GetSyntaxToken(SyntaxKind.UsingKeyword))))
        .WithMembers(
            SingletonList<MemberDeclarationSyntax>(
                FileScopedNamespaceDeclaration(
                        QualifiedName(
                            IdentifierName("SignalRGen"),
                            IdentifierName("Generator")))
                    .WithNamespaceKeyword(NullableEnabledSource.GetSyntaxToken(SyntaxKind.NamespaceKeyword))
                    .WithMembers(
                        SingletonList<MemberDeclarationSyntax>(
                            ClassDeclaration("HubClientBase")
                                .WithModifiers(
                                    TokenList(
                                        new[]
                                        {
                                            Token(
                                                TriviaList(
                                                    Trivia(
                                                        DocumentationCommentTrivia(
                                                            SyntaxKind.SingleLineDocumentationCommentTrivia,
                                                            List<XmlNodeSyntax>(
                                                                new XmlNodeSyntax[]
                                                                {
                                                                    XmlText()
                                                                        .WithTextTokens(
                                                                            TokenList(
                                                                                XmlTextLiteral(
                                                                                    TriviaList(
                                                                                        DocumentationCommentExterior(
                                                                                            "///")),
                                                                                    " ",
                                                                                    " ",
                                                                                    TriviaList()))),
                                                                    XmlExampleElement(
                                                                            SingletonList<XmlNodeSyntax>(
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            new[]
                                                                                            {
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList()),
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " Base class for generated HubClients.",
                                                                                                    " Base class for generated HubClients.",
                                                                                                    TriviaList()),
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList()),
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " ",
                                                                                                    " ",
                                                                                                    TriviaList())
                                                                                            }))))
                                                                        .WithStartTag(
                                                                            XmlElementStartTag(
                                                                                XmlName(
                                                                                    Identifier("summary"))))
                                                                        .WithEndTag(
                                                                            XmlElementEndTag(
                                                                                XmlName(
                                                                                    Identifier("summary")))),
                                                                    XmlText()
                                                                        .WithTextTokens(
                                                                            TokenList(
                                                                                new[]
                                                                                {
                                                                                    XmlTextNewLine(
                                                                                        TriviaList(),
                                                                                        "\n",
                                                                                        "\n",
                                                                                        TriviaList()),
                                                                                    XmlTextLiteral(
                                                                                        TriviaList(
                                                                                            DocumentationCommentExterior(
                                                                                                "///")),
                                                                                        " ",
                                                                                        " ",
                                                                                        TriviaList())
                                                                                })),
                                                                    XmlExampleElement(
                                                                            SingletonList<XmlNodeSyntax>(
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            new[]
                                                                                            {
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList()),
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " This base is partial to allow for extensions for all clients.",
                                                                                                    " This base is partial to allow for extensions for all clients.",
                                                                                                    TriviaList()),
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList()),
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " Be aware that any extended behavior might result in the need to rewrite the DisposeAsync.",
                                                                                                    " Be aware that any extended behavior might result in the need to rewrite the DisposeAsync.",
                                                                                                    TriviaList()),
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList()),
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " ",
                                                                                                    " ",
                                                                                                    TriviaList())
                                                                                            }))))
                                                                        .WithStartTag(
                                                                            XmlElementStartTag(
                                                                                XmlName(
                                                                                    Identifier("remarks"))))
                                                                        .WithEndTag(
                                                                            XmlElementEndTag(
                                                                                XmlName(
                                                                                    Identifier("remarks")))),
                                                                    XmlText()
                                                                        .WithTextTokens(
                                                                            TokenList(
                                                                                XmlTextNewLine(
                                                                                    TriviaList(),
                                                                                    "\n",
                                                                                    "\n",
                                                                                    TriviaList())))
                                                                })))),
                                                SyntaxKind.PublicKeyword,
                                                TriviaList()),
                                            Token(SyntaxKind.AbstractKeyword),
                                            Token(SyntaxKind.PartialKeyword)
                                        }))
                                .WithBaseList(
                                    BaseList(
                                        SingletonSeparatedList<BaseTypeSyntax>(
                                            SimpleBaseType(
                                                IdentifierName("IAsyncDisposable")))))
                                .WithMembers(
                                    List<MemberDeclarationSyntax>(
                                        new MemberDeclarationSyntax[]
                                        {
                                            FieldDeclaration(
                                                    VariableDeclaration(
                                                            PredefinedType(
                                                                Token(SyntaxKind.BoolKeyword)))
                                                        .WithVariables(
                                                            SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                VariableDeclarator(
                                                                    Identifier("_isRegistered")))))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(SyntaxKind.ProtectedKeyword))),
                                            FieldDeclaration(
                                                    VariableDeclaration(
                                                            NullableType(
                                                                IdentifierName("HubConnection")))
                                                        .WithVariables(
                                                            SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                VariableDeclarator(
                                                                    Identifier("_hubConnection")))))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(SyntaxKind.ProtectedKeyword))),
                                            FieldDeclaration(
                                                    VariableDeclaration(
                                                            IdentifierName("IHubConnectionBuilder"))
                                                        .WithVariables(
                                                            SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                VariableDeclarator(
                                                                    Identifier("HubConnectionBuilder")))))
                                                .WithModifiers(
                                                    TokenList(
                                                        new[]
                                                        {
                                                            Token(SyntaxKind.ProtectedKeyword),
                                                            Token(SyntaxKind.ReadOnlyKeyword)
                                                        })),
                                            FieldDeclaration(
                                                    VariableDeclaration(
                                                            NullableType(
                                                                GenericName(
                                                                        Identifier("Func"))
                                                                    .WithTypeArgumentList(
                                                                        TypeArgumentList(
                                                                            SeparatedList<TypeSyntax>(
                                                                                new SyntaxNodeOrToken[]
                                                                                {
                                                                                    NullableType(
                                                                                        IdentifierName("Exception")),
                                                                                    Token(SyntaxKind.CommaToken),
                                                                                    IdentifierName("Task")
                                                                                })))))
                                                        .WithVariables(
                                                            SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                VariableDeclarator(
                                                                    Identifier("Closed")))))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(
                                                            TriviaList(
                                                                Trivia(
                                                                    DocumentationCommentTrivia(
                                                                        SyntaxKind.SingleLineDocumentationCommentTrivia,
                                                                        List<XmlNodeSyntax>(
                                                                            new XmlNodeSyntax[]
                                                                            {
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextLiteral(
                                                                                                TriviaList(
                                                                                                    DocumentationCommentExterior(
                                                                                                        "///")),
                                                                                                " ",
                                                                                                " ",
                                                                                                TriviaList()))),
                                                                                XmlExampleElement(
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " Gets invoked each time the Closed event from the underlying ",
                                                                                                            " Gets invoked each time the Closed event from the underlying ",
                                                                                                            TriviaList())
                                                                                                    })),
                                                                                        XmlNullKeywordElement()
                                                                                            .WithAttributes(
                                                                                                SingletonList<
                                                                                                    XmlAttributeSyntax>(
                                                                                                    XmlCrefAttribute(
                                                                                                        NameMemberCref(
                                                                                                            IdentifierName(
                                                                                                                "HubConnection"))))),
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            " occurs.",
                                                                                                            " occurs.",
                                                                                                            TriviaList()),
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " ",
                                                                                                            " ",
                                                                                                            TriviaList())
                                                                                                    })))
                                                                                    .WithStartTag(
                                                                                        XmlElementStartTag(
                                                                                            XmlName(
                                                                                                Identifier("summary"))))
                                                                                    .WithEndTag(
                                                                                        XmlElementEndTag(
                                                                                            XmlName(
                                                                                                Identifier(
                                                                                                    "summary")))),
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextNewLine(
                                                                                                TriviaList(),
                                                                                                "\n",
                                                                                                "\n",
                                                                                                TriviaList())))
                                                                            })))),
                                                            SyntaxKind.PublicKeyword,
                                                            TriviaList()))),
                                            FieldDeclaration(
                                                    VariableDeclaration(
                                                            NullableType(
                                                                GenericName(
                                                                        Identifier("Func"))
                                                                    .WithTypeArgumentList(
                                                                        TypeArgumentList(
                                                                            SeparatedList<TypeSyntax>(
                                                                                new SyntaxNodeOrToken[]
                                                                                {
                                                                                    NullableType(
                                                                                        IdentifierName("Exception")),
                                                                                    Token(SyntaxKind.CommaToken),
                                                                                    IdentifierName("Task")
                                                                                })))))
                                                        .WithVariables(
                                                            SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                VariableDeclarator(
                                                                    Identifier("Reconnecting")))))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(
                                                            TriviaList(
                                                                Trivia(
                                                                    DocumentationCommentTrivia(
                                                                        SyntaxKind.SingleLineDocumentationCommentTrivia,
                                                                        List<XmlNodeSyntax>(
                                                                            new XmlNodeSyntax[]
                                                                            {
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextLiteral(
                                                                                                TriviaList(
                                                                                                    DocumentationCommentExterior(
                                                                                                        "///")),
                                                                                                " ",
                                                                                                " ",
                                                                                                TriviaList()))),
                                                                                XmlExampleElement(
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " Gets invoked each time the Reconnecting event from the underlying ",
                                                                                                            " Gets invoked each time the Reconnecting event from the underlying ",
                                                                                                            TriviaList())
                                                                                                    })),
                                                                                        XmlNullKeywordElement()
                                                                                            .WithAttributes(
                                                                                                SingletonList<
                                                                                                    XmlAttributeSyntax>(
                                                                                                    XmlCrefAttribute(
                                                                                                        NameMemberCref(
                                                                                                            IdentifierName(
                                                                                                                "HubConnection"))))),
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            " occurs.",
                                                                                                            " occurs.",
                                                                                                            TriviaList()),
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " ",
                                                                                                            " ",
                                                                                                            TriviaList())
                                                                                                    })))
                                                                                    .WithStartTag(
                                                                                        XmlElementStartTag(
                                                                                            XmlName(
                                                                                                Identifier("summary"))))
                                                                                    .WithEndTag(
                                                                                        XmlElementEndTag(
                                                                                            XmlName(
                                                                                                Identifier(
                                                                                                    "summary")))),
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextNewLine(
                                                                                                TriviaList(),
                                                                                                "\n",
                                                                                                "\n",
                                                                                                TriviaList())))
                                                                            })))),
                                                            SyntaxKind.PublicKeyword,
                                                            TriviaList()))),
                                            FieldDeclaration(
                                                    VariableDeclaration(
                                                            NullableType(
                                                                GenericName(
                                                                        Identifier("Func"))
                                                                    .WithTypeArgumentList(
                                                                        TypeArgumentList(
                                                                            SingletonSeparatedList<TypeSyntax>(
                                                                                IdentifierName("Task"))))))
                                                        .WithVariables(
                                                            SingletonSeparatedList<VariableDeclaratorSyntax>(
                                                                VariableDeclarator(
                                                                    Identifier("Reconnected")))))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(
                                                            TriviaList(
                                                                Trivia(
                                                                    DocumentationCommentTrivia(
                                                                        SyntaxKind.SingleLineDocumentationCommentTrivia,
                                                                        List<XmlNodeSyntax>(
                                                                            new XmlNodeSyntax[]
                                                                            {
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextLiteral(
                                                                                                TriviaList(
                                                                                                    DocumentationCommentExterior(
                                                                                                        "///")),
                                                                                                " ",
                                                                                                " ",
                                                                                                TriviaList()))),
                                                                                XmlExampleElement(
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " Gets invoked each time the reconnected event from the underlying ",
                                                                                                            " Gets invoked each time the reconnected event from the underlying ",
                                                                                                            TriviaList())
                                                                                                    })),
                                                                                        XmlNullKeywordElement()
                                                                                            .WithAttributes(
                                                                                                SingletonList<
                                                                                                    XmlAttributeSyntax>(
                                                                                                    XmlCrefAttribute(
                                                                                                        NameMemberCref(
                                                                                                            IdentifierName(
                                                                                                                "HubConnection"))))),
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            " occurs.",
                                                                                                            " occurs.",
                                                                                                            TriviaList()),
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " ",
                                                                                                            " ",
                                                                                                            TriviaList())
                                                                                                    })))
                                                                                    .WithStartTag(
                                                                                        XmlElementStartTag(
                                                                                            XmlName(
                                                                                                Identifier("summary"))))
                                                                                    .WithEndTag(
                                                                                        XmlElementEndTag(
                                                                                            XmlName(
                                                                                                Identifier(
                                                                                                    "summary")))),
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextNewLine(
                                                                                                TriviaList(),
                                                                                                "\n",
                                                                                                "\n",
                                                                                                TriviaList())))
                                                                            })))),
                                                            SyntaxKind.PublicKeyword,
                                                            TriviaList()))),
                                            ConstructorDeclaration(
                                                    Identifier("HubClientBase"))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(SyntaxKind.ProtectedKeyword)))
                                                .WithParameterList(
                                                    ParameterList(
                                                        SingletonSeparatedList<ParameterSyntax>(
                                                            Parameter(
                                                                    Identifier("hubConnectionBuilder"))
                                                                .WithType(
                                                                    IdentifierName("IHubConnectionBuilder")))))
                                                .WithBody(
                                                    Block(
                                                        SingletonList<StatementSyntax>(
                                                            ExpressionStatement(
                                                                AssignmentExpression(
                                                                    SyntaxKind.SimpleAssignmentExpression,
                                                                    IdentifierName("HubConnectionBuilder"),
                                                                    IdentifierName("hubConnectionBuilder")))))),
                                            MethodDeclaration(
                                                    IdentifierName("Task"),
                                                    Identifier("StartAsync"))
                                                .WithModifiers(
                                                    TokenList(
                                                        new[]
                                                        {
                                                            Token(
                                                                TriviaList(
                                                                    Trivia(
                                                                        DocumentationCommentTrivia(
                                                                            SyntaxKind
                                                                                .SingleLineDocumentationCommentTrivia,
                                                                            List<XmlNodeSyntax>(
                                                                                new XmlNodeSyntax[]
                                                                                {
                                                                                    XmlText()
                                                                                        .WithTextTokens(
                                                                                            TokenList(
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " ",
                                                                                                    " ",
                                                                                                    TriviaList()))),
                                                                                    XmlExampleElement(
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        new[]
                                                                                                        {
                                                                                                            XmlTextNewLine(
                                                                                                                TriviaList(),
                                                                                                                "\n",
                                                                                                                "\n",
                                                                                                                TriviaList()),
                                                                                                            XmlTextLiteral(
                                                                                                                TriviaList(
                                                                                                                    DocumentationCommentExterior(
                                                                                                                        "    ///")),
                                                                                                                " Asynchronously starts the underlying ",
                                                                                                                " Asynchronously starts the underlying ",
                                                                                                                TriviaList())
                                                                                                        })),
                                                                                            XmlNullKeywordElement()
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlCrefAttribute(
                                                                                                            NameMemberCref(
                                                                                                                IdentifierName(
                                                                                                                    "HubConnection"))))),
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        new[]
                                                                                                        {
                                                                                                            XmlTextLiteral(
                                                                                                                TriviaList(),
                                                                                                                " and registers the event callbacks for the SignalR client methods.",
                                                                                                                " and registers the event callbacks for the SignalR client methods.",
                                                                                                                TriviaList()),
                                                                                                            XmlTextNewLine(
                                                                                                                TriviaList(),
                                                                                                                "\n",
                                                                                                                "\n",
                                                                                                                TriviaList()),
                                                                                                            XmlTextLiteral(
                                                                                                                TriviaList(
                                                                                                                    DocumentationCommentExterior(
                                                                                                                        "    ///")),
                                                                                                                " ",
                                                                                                                " ",
                                                                                                                TriviaList())
                                                                                                        })))
                                                                                        .WithStartTag(
                                                                                            XmlElementStartTag(
                                                                                                XmlName(
                                                                                                    Identifier(
                                                                                                        "summary"))))
                                                                                        .WithEndTag(
                                                                                            XmlElementEndTag(
                                                                                                XmlName(
                                                                                                    Identifier(
                                                                                                        "summary")))),
                                                                                    XmlText()
                                                                                        .WithTextTokens(
                                                                                            TokenList(
                                                                                                new[]
                                                                                                {
                                                                                                    XmlTextNewLine(
                                                                                                        TriviaList(),
                                                                                                        "\n",
                                                                                                        "\n",
                                                                                                        TriviaList()),
                                                                                                    XmlTextLiteral(
                                                                                                        TriviaList(
                                                                                                            DocumentationCommentExterior(
                                                                                                                "    ///")),
                                                                                                        " ",
                                                                                                        " ",
                                                                                                        TriviaList())
                                                                                                })),
                                                                                    XmlExampleElement(
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            "A ",
                                                                                                            "A ",
                                                                                                            TriviaList()))),
                                                                                            XmlNullKeywordElement()
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlCrefAttribute(
                                                                                                            NameMemberCref(
                                                                                                                IdentifierName(
                                                                                                                    "CancellationToken"))))),
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            " to cancel the start of the ",
                                                                                                            " to cancel the start of the ",
                                                                                                            TriviaList()))),
                                                                                            XmlNullKeywordElement()
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlCrefAttribute(
                                                                                                            NameMemberCref(
                                                                                                                IdentifierName(
                                                                                                                    "HubConnection"))))),
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            ".",
                                                                                                            ".",
                                                                                                            TriviaList()))))
                                                                                        .WithStartTag(
                                                                                            XmlElementStartTag(
                                                                                                    XmlName(
                                                                                                        Identifier(
                                                                                                            TriviaList(),
                                                                                                            SyntaxKind
                                                                                                                .ParamKeyword,
                                                                                                            "param",
                                                                                                            "param",
                                                                                                            TriviaList())))
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlNameAttribute(
                                                                                                            XmlName(
                                                                                                                Identifier(
                                                                                                                    "name")),
                                                                                                            Token(
                                                                                                                SyntaxKind
                                                                                                                    .DoubleQuoteToken),
                                                                                                            IdentifierName(
                                                                                                                "cancellationToken"),
                                                                                                            Token(
                                                                                                                SyntaxKind
                                                                                                                    .DoubleQuoteToken)))))
                                                                                        .WithEndTag(
                                                                                            XmlElementEndTag(
                                                                                                XmlName(
                                                                                                    Identifier(
                                                                                                        TriviaList(),
                                                                                                        SyntaxKind
                                                                                                            .ParamKeyword,
                                                                                                        "param",
                                                                                                        "param",
                                                                                                        TriviaList())))),
                                                                                    XmlText()
                                                                                        .WithTextTokens(
                                                                                            TokenList(
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList())))
                                                                                })))),
                                                                SyntaxKind.PublicKeyword,
                                                                TriviaList()),
                                                            Token(SyntaxKind.VirtualKeyword)
                                                        }))
                                                .WithParameterList(
                                                    ParameterList(
                                                        SingletonSeparatedList<ParameterSyntax>(
                                                            Parameter(
                                                                    Identifier("cancellationToken"))
                                                                .WithType(
                                                                    IdentifierName("CancellationToken"))
                                                                .WithDefault(
                                                                    EqualsValueClause(
                                                                        LiteralExpression(
                                                                            SyntaxKind.DefaultLiteralExpression,
                                                                            Token(SyntaxKind.DefaultKeyword)))))))
                                                .WithBody(
                                                    Block(
                                                        ExpressionStatement(
                                                            AssignmentExpression(
                                                                SyntaxKind.CoalesceAssignmentExpression,
                                                                IdentifierName("_hubConnection"),
                                                                InvocationExpression(
                                                                    MemberAccessExpression(
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        IdentifierName("HubConnectionBuilder"),
                                                                        IdentifierName("Build"))))),
                                                        IfStatement(
                                                            PrefixUnaryExpression(
                                                                SyntaxKind.LogicalNotExpression,
                                                                IdentifierName("_isRegistered")),
                                                            Block(
                                                                ExpressionStatement(
                                                                    AssignmentExpression(
                                                                        SyntaxKind.AddAssignmentExpression,
                                                                        MemberAccessExpression(
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            IdentifierName("_hubConnection"),
                                                                            IdentifierName("Closed")),
                                                                        IdentifierName("Closed"))),
                                                                ExpressionStatement(
                                                                    AssignmentExpression(
                                                                        SyntaxKind.AddAssignmentExpression,
                                                                        MemberAccessExpression(
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            IdentifierName("_hubConnection"),
                                                                            IdentifierName("Reconnected")),
                                                                        IdentifierName("OnReconnected"))),
                                                                ExpressionStatement(
                                                                    AssignmentExpression(
                                                                        SyntaxKind.AddAssignmentExpression,
                                                                        MemberAccessExpression(
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            IdentifierName("_hubConnection"),
                                                                            IdentifierName("Reconnecting")),
                                                                        IdentifierName("Reconnecting"))),
                                                                ExpressionStatement(
                                                                    InvocationExpression(
                                                                        IdentifierName("RegisterHubMethods"))),
                                                                ExpressionStatement(
                                                                    AssignmentExpression(
                                                                        SyntaxKind.SimpleAssignmentExpression,
                                                                        IdentifierName("_isRegistered"),
                                                                        LiteralExpression(
                                                                            SyntaxKind.TrueLiteralExpression))))),
                                                        ReturnStatement(
                                                            ConditionalExpression(
                                                                BinaryExpression(
                                                                    SyntaxKind.EqualsExpression,
                                                                    MemberAccessExpression(
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        IdentifierName("_hubConnection"),
                                                                        IdentifierName("State")),
                                                                    MemberAccessExpression(
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        IdentifierName("HubConnectionState"),
                                                                        IdentifierName("Disconnected"))),
                                                                InvocationExpression(
                                                                        MemberAccessExpression(
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            IdentifierName("_hubConnection"),
                                                                            IdentifierName("StartAsync")))
                                                                    .WithArgumentList(
                                                                        ArgumentList(
                                                                            SingletonSeparatedList<ArgumentSyntax>(
                                                                                Argument(
                                                                                    IdentifierName(
                                                                                        "cancellationToken"))))),
                                                                MemberAccessExpression(
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    IdentifierName("Task"),
                                                                    IdentifierName("CompletedTask")))))),
                                            MethodDeclaration(
                                                    IdentifierName("Task"),
                                                    Identifier("StopAsync"))
                                                .WithModifiers(
                                                    TokenList(
                                                        new[]
                                                        {
                                                            Token(
                                                                TriviaList(
                                                                    Trivia(
                                                                        DocumentationCommentTrivia(
                                                                            SyntaxKind
                                                                                .SingleLineDocumentationCommentTrivia,
                                                                            List<XmlNodeSyntax>(
                                                                                new XmlNodeSyntax[]
                                                                                {
                                                                                    XmlText()
                                                                                        .WithTextTokens(
                                                                                            TokenList(
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "///")),
                                                                                                    " ",
                                                                                                    " ",
                                                                                                    TriviaList()))),
                                                                                    XmlExampleElement(
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        new[]
                                                                                                        {
                                                                                                            XmlTextNewLine(
                                                                                                                TriviaList(),
                                                                                                                "\n",
                                                                                                                "\n",
                                                                                                                TriviaList()),
                                                                                                            XmlTextLiteral(
                                                                                                                TriviaList(
                                                                                                                    DocumentationCommentExterior(
                                                                                                                        "    ///")),
                                                                                                                " Asynchronously stops the underlying ",
                                                                                                                " Asynchronously stops the underlying ",
                                                                                                                TriviaList())
                                                                                                        })),
                                                                                            XmlNullKeywordElement()
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlCrefAttribute(
                                                                                                            NameMemberCref(
                                                                                                                IdentifierName(
                                                                                                                    "HubConnection"))))),
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        new[]
                                                                                                        {
                                                                                                            XmlTextLiteral(
                                                                                                                TriviaList(),
                                                                                                                ".",
                                                                                                                ".",
                                                                                                                TriviaList()),
                                                                                                            XmlTextNewLine(
                                                                                                                TriviaList(),
                                                                                                                "\n",
                                                                                                                "\n",
                                                                                                                TriviaList()),
                                                                                                            XmlTextLiteral(
                                                                                                                TriviaList(
                                                                                                                    DocumentationCommentExterior(
                                                                                                                        "    ///")),
                                                                                                                " ",
                                                                                                                " ",
                                                                                                                TriviaList())
                                                                                                        })))
                                                                                        .WithStartTag(
                                                                                            XmlElementStartTag(
                                                                                                XmlName(
                                                                                                    Identifier(
                                                                                                        "summary"))))
                                                                                        .WithEndTag(
                                                                                            XmlElementEndTag(
                                                                                                XmlName(
                                                                                                    Identifier(
                                                                                                        "summary")))),
                                                                                    XmlText()
                                                                                        .WithTextTokens(
                                                                                            TokenList(
                                                                                                new[]
                                                                                                {
                                                                                                    XmlTextNewLine(
                                                                                                        TriviaList(),
                                                                                                        "\n",
                                                                                                        "\n",
                                                                                                        TriviaList()),
                                                                                                    XmlTextLiteral(
                                                                                                        TriviaList(
                                                                                                            DocumentationCommentExterior(
                                                                                                                "    ///")),
                                                                                                        " ",
                                                                                                        " ",
                                                                                                        TriviaList())
                                                                                                })),
                                                                                    XmlExampleElement(
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            "A ",
                                                                                                            "A ",
                                                                                                            TriviaList()))),
                                                                                            XmlNullKeywordElement()
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlCrefAttribute(
                                                                                                            NameMemberCref(
                                                                                                                IdentifierName(
                                                                                                                    "CancellationToken"))))),
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            " to cancel the stop of the ",
                                                                                                            " to cancel the stop of the ",
                                                                                                            TriviaList()))),
                                                                                            XmlNullKeywordElement()
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlCrefAttribute(
                                                                                                            NameMemberCref(
                                                                                                                IdentifierName(
                                                                                                                    "HubConnection"))))),
                                                                                            XmlText()
                                                                                                .WithTextTokens(
                                                                                                    TokenList(
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            ".",
                                                                                                            ".",
                                                                                                            TriviaList()))))
                                                                                        .WithStartTag(
                                                                                            XmlElementStartTag(
                                                                                                    XmlName(
                                                                                                        Identifier(
                                                                                                            TriviaList(),
                                                                                                            SyntaxKind
                                                                                                                .ParamKeyword,
                                                                                                            "param",
                                                                                                            "param",
                                                                                                            TriviaList())))
                                                                                                .WithAttributes(
                                                                                                    SingletonList<
                                                                                                        XmlAttributeSyntax>(
                                                                                                        XmlNameAttribute(
                                                                                                            XmlName(
                                                                                                                Identifier(
                                                                                                                    "name")),
                                                                                                            Token(
                                                                                                                SyntaxKind
                                                                                                                    .DoubleQuoteToken),
                                                                                                            IdentifierName(
                                                                                                                "cancellationToken"),
                                                                                                            Token(
                                                                                                                SyntaxKind
                                                                                                                    .DoubleQuoteToken)))))
                                                                                        .WithEndTag(
                                                                                            XmlElementEndTag(
                                                                                                XmlName(
                                                                                                    Identifier(
                                                                                                        TriviaList(),
                                                                                                        SyntaxKind
                                                                                                            .ParamKeyword,
                                                                                                        "param",
                                                                                                        "param",
                                                                                                        TriviaList())))),
                                                                                    XmlText()
                                                                                        .WithTextTokens(
                                                                                            TokenList(
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList())))
                                                                                })))),
                                                                SyntaxKind.PublicKeyword,
                                                                TriviaList()),
                                                            Token(SyntaxKind.VirtualKeyword)
                                                        }))
                                                .WithParameterList(
                                                    ParameterList(
                                                        SingletonSeparatedList<ParameterSyntax>(
                                                            Parameter(
                                                                    Identifier("cancellationToken"))
                                                                .WithType(
                                                                    IdentifierName("CancellationToken"))
                                                                .WithDefault(
                                                                    EqualsValueClause(
                                                                        LiteralExpression(
                                                                            SyntaxKind.DefaultLiteralExpression,
                                                                            Token(SyntaxKind.DefaultKeyword)))))))
                                                .WithBody(
                                                    Block(
                                                        SingletonList<StatementSyntax>(
                                                            ReturnStatement(
                                                                ConditionalExpression(
                                                                    IsPatternExpression(
                                                                        IdentifierName("_hubConnection"),
                                                                        ConstantPattern(
                                                                            LiteralExpression(
                                                                                SyntaxKind.NullLiteralExpression))),
                                                                    MemberAccessExpression(
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        IdentifierName("Task"),
                                                                        IdentifierName("CompletedTask")),
                                                                    InvocationExpression(
                                                                            MemberAccessExpression(
                                                                                SyntaxKind.SimpleMemberAccessExpression,
                                                                                IdentifierName("_hubConnection"),
                                                                                IdentifierName("StopAsync")))
                                                                        .WithArgumentList(
                                                                            ArgumentList(
                                                                                SingletonSeparatedList<ArgumentSyntax>(
                                                                                    Argument(
                                                                                        IdentifierName(
                                                                                            "cancellationToken")))))))))),
                                            MethodDeclaration(
                                                    PredefinedType(
                                                        Token(SyntaxKind.VoidKeyword)),
                                                    Identifier("RegisterHubMethods"))
                                                .WithModifiers(
                                                    TokenList(
                                                        new[]
                                                        {
                                                            Token(SyntaxKind.ProtectedKeyword),
                                                            Token(SyntaxKind.AbstractKeyword)
                                                        }))
                                                .WithSemicolonToken(
                                                    Token(SyntaxKind.SemicolonToken)),
                                            MethodDeclaration(
                                                    IdentifierName("Task"),
                                                    Identifier("OnReconnected"))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(SyntaxKind.PrivateKeyword)))
                                                .WithParameterList(
                                                    ParameterList(
                                                        SingletonSeparatedList<ParameterSyntax>(
                                                            Parameter(
                                                                    Identifier("connectionId"))
                                                                .WithType(
                                                                    NullableType(
                                                                        PredefinedType(
                                                                            Token(SyntaxKind.StringKeyword)))))))
                                                .WithBody(
                                                    Block(
                                                        SingletonList<StatementSyntax>(
                                                            ReturnStatement(
                                                                ConditionalExpression(
                                                                    IsPatternExpression(
                                                                        IdentifierName("Reconnected"),
                                                                        UnaryPattern(
                                                                            ConstantPattern(
                                                                                LiteralExpression(
                                                                                    SyntaxKind
                                                                                        .NullLiteralExpression)))),
                                                                    InvocationExpression(
                                                                        MemberAccessExpression(
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            IdentifierName("Reconnected"),
                                                                            IdentifierName("Invoke"))),
                                                                    MemberAccessExpression(
                                                                        SyntaxKind.SimpleMemberAccessExpression,
                                                                        IdentifierName("Task"),
                                                                        IdentifierName("CompletedTask"))))))),
                                            MethodDeclaration(
                                                    IdentifierName("ValueTask"),
                                                    Identifier("DisposeAsync"))
                                                .WithModifiers(
                                                    TokenList(
                                                        Token(
                                                            TriviaList(
                                                                Trivia(
                                                                    DocumentationCommentTrivia(
                                                                        SyntaxKind.SingleLineDocumentationCommentTrivia,
                                                                        List<XmlNodeSyntax>(
                                                                            new XmlNodeSyntax[]
                                                                            {
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextLiteral(
                                                                                                TriviaList(
                                                                                                    DocumentationCommentExterior(
                                                                                                        "///")),
                                                                                                " ",
                                                                                                " ",
                                                                                                TriviaList()))),
                                                                                XmlExampleElement(
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " Releases resources for the underlying ",
                                                                                                            " Releases resources for the underlying ",
                                                                                                            TriviaList())
                                                                                                    })),
                                                                                        XmlNullKeywordElement()
                                                                                            .WithAttributes(
                                                                                                SingletonList<
                                                                                                    XmlAttributeSyntax>(
                                                                                                    XmlCrefAttribute(
                                                                                                        NameMemberCref(
                                                                                                            IdentifierName(
                                                                                                                "HubConnection"))))),
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    new[]
                                                                                                    {
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(),
                                                                                                            ".",
                                                                                                            ".",
                                                                                                            TriviaList()),
                                                                                                        XmlTextNewLine(
                                                                                                            TriviaList(),
                                                                                                            "\n",
                                                                                                            "\n",
                                                                                                            TriviaList()),
                                                                                                        XmlTextLiteral(
                                                                                                            TriviaList(
                                                                                                                DocumentationCommentExterior(
                                                                                                                    "    ///")),
                                                                                                            " ",
                                                                                                            " ",
                                                                                                            TriviaList())
                                                                                                    })))
                                                                                    .WithStartTag(
                                                                                        XmlElementStartTag(
                                                                                            XmlName(
                                                                                                Identifier("summary"))))
                                                                                    .WithEndTag(
                                                                                        XmlElementEndTag(
                                                                                            XmlName(
                                                                                                Identifier(
                                                                                                    "summary")))),
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            new[]
                                                                                            {
                                                                                                XmlTextNewLine(
                                                                                                    TriviaList(),
                                                                                                    "\n",
                                                                                                    "\n",
                                                                                                    TriviaList()),
                                                                                                XmlTextLiteral(
                                                                                                    TriviaList(
                                                                                                        DocumentationCommentExterior(
                                                                                                            "    ///")),
                                                                                                    " ",
                                                                                                    " ",
                                                                                                    TriviaList())
                                                                                            })),
                                                                                XmlExampleElement(
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    XmlTextLiteral(
                                                                                                        TriviaList(),
                                                                                                        "A ",
                                                                                                        "A ",
                                                                                                        TriviaList()))),
                                                                                        XmlNullKeywordElement()
                                                                                            .WithAttributes(
                                                                                                SingletonList<
                                                                                                    XmlAttributeSyntax>(
                                                                                                    XmlCrefAttribute(
                                                                                                        NameMemberCref(
                                                                                                            IdentifierName(
                                                                                                                "ValueTask"))))),
                                                                                        XmlText()
                                                                                            .WithTextTokens(
                                                                                                TokenList(
                                                                                                    XmlTextLiteral(
                                                                                                        TriviaList(),
                                                                                                        " that completes when resources have been released.",
                                                                                                        " that completes when resources have been released.",
                                                                                                        TriviaList()))))
                                                                                    .WithStartTag(
                                                                                        XmlElementStartTag(
                                                                                            XmlName(
                                                                                                Identifier("returns"))))
                                                                                    .WithEndTag(
                                                                                        XmlElementEndTag(
                                                                                            XmlName(
                                                                                                Identifier(
                                                                                                    "returns")))),
                                                                                XmlText()
                                                                                    .WithTextTokens(
                                                                                        TokenList(
                                                                                            XmlTextNewLine(
                                                                                                TriviaList(),
                                                                                                "\n",
                                                                                                "\n",
                                                                                                TriviaList())))
                                                                            })))),
                                                            SyntaxKind.PublicKeyword,
                                                            TriviaList())))
                                                .WithBody(
                                                    Block(
                                                        IfStatement(
                                                            IsPatternExpression(
                                                                IdentifierName("_hubConnection"),
                                                                ConstantPattern(
                                                                    LiteralExpression(
                                                                        SyntaxKind.NullLiteralExpression))),
                                                            Block(
                                                                SingletonList<StatementSyntax>(
                                                                    ReturnStatement(
                                                                        MemberAccessExpression(
                                                                            SyntaxKind.SimpleMemberAccessExpression,
                                                                            IdentifierName("ValueTask"),
                                                                            IdentifierName("CompletedTask")))))),
                                                        ExpressionStatement(
                                                            AssignmentExpression(
                                                                SyntaxKind.SubtractAssignmentExpression,
                                                                MemberAccessExpression(
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    IdentifierName("_hubConnection"),
                                                                    IdentifierName("Closed")),
                                                                IdentifierName("Closed"))),
                                                        ExpressionStatement(
                                                            AssignmentExpression(
                                                                SyntaxKind.SubtractAssignmentExpression,
                                                                MemberAccessExpression(
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    IdentifierName("_hubConnection"),
                                                                    IdentifierName("Reconnected")),
                                                                IdentifierName("OnReconnected"))),
                                                        ExpressionStatement(
                                                            AssignmentExpression(
                                                                SyntaxKind.SubtractAssignmentExpression,
                                                                MemberAccessExpression(
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    IdentifierName("_hubConnection"),
                                                                    IdentifierName("Reconnecting")),
                                                                IdentifierName("Reconnecting"))),
                                                        ReturnStatement(
                                                            InvocationExpression(
                                                                MemberAccessExpression(
                                                                    SyntaxKind.SimpleMemberAccessExpression,
                                                                    IdentifierName("_hubConnection"),
                                                                    IdentifierName("DisposeAsync"))))))
                                        }))))))
        .NormalizeWhitespace()
        .GetText(Encoding.UTF8);
}