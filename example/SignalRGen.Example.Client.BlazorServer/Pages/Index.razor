@page "/"
@using SignalRGen.Generator

@inject ExampleHubClient ExampleHubClient;

<h1>Hello, world!</h1>

<p>Current count received via SignalRClient generated by SignalRGen: @_count</p>

<button @onclick="SendMessage">Send Message to Server</button>
<p>@_returnValue</p>

@code
{
    private int _count = 0;
    private string _returnValue = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        ExampleHubClient.OnReceiveExampleCountUpdate += OnReceiveExampleCountUpdate;
        await ExampleHubClient.StartAsync();
    }

    private async Task OnReceiveExampleCountUpdate(int arg)
    {
        _count = arg;
        await InvokeAsync(StateHasChanged);
    }

    private async Task SendMessage()
    {
        _returnValue = await ExampleHubClient.InvokeSendExampleMessageAsync("This is my message from the client to the server");
    }
}
